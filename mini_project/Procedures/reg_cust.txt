CREATE OR REPLACE PROCEDURE REG_CUST(
	P_CUST_MOBILE CUSTOMER.CUST_MOBILE%TYPE,
	P_CUST_NAME CUSTOMER.CUST_NAME%TYPE,
	P_CUST_ADDR CUSTOMER.CUST_ADDR%TYPE,
	P_CUST_CITY CUSTOMER.CUST_CITY%TYPE,
	P_USER_PASSWORD USER_LOGIN.LOG_PASS%TYPE
) IS
CURSOR CUR_MOBILE IS SELECT CUST_MOBILE FROM CUSTOMER;
CHECK_CONSTRAINT_VIOLATED EXCEPTION;
PRAGMA EXCEPTION_INIT ( CHECK_CONSTRAINT_VIOLATED, -2290 );
BEGIN
	INSERT INTO CUSTOMER
	VALUES(P_CUST_MOBILE,P_CUST_NAME,P_CUST_ADDR,P_CUST_CITY);
	IF SQL%FOUND THEN
		INSERT INTO USER_LOGIN
		VALUES(P_CUST_MOBILE,P_USER_PASSWORD,'CUSTOMER');
	END IF;
	COMMIT;
	DBMS_OUTPUT.PUT_LINE('CUSTOMER REGISTERED');
	DBMS_OUTPUT.PUT_LINE('PLEASE LOGIN BY WRITING');
	DBMS_OUTPUT.PUT_LINE('EXEC LOGIN(<YOUR ID>,<YOUR PASSWORD>)');
EXCEPTION 
	WHEN DUP_VAL_ON_INDEX THEN
		DBMS_OUTPUT.PUT_LINE('ACCOUNT ALREADY PRESENT');
		DBMS_OUTPUT.PUT_LINE('CUSTOMER NOT REGISTERED');
	WHEN CHECK_CONSTRAINT_VIOLATED THEN
		DBMS_OUTPUT.PUT_LINE('PHONE NUMBER NOT OF 10 DIGITS');
		DBMS_OUTPUT.PUT_LINE('CUSTOMER NOT REGISTERED');
END REG_CUST;